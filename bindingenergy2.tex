
The above analysis lays the foundation for understanding the behavior of a transcription factor (protein) that binds in a solution with identical sequences (DNA oligos for example).  One can imagine the solvent as the oligos, and use standard partition functions, or one can work in a frame where the oligos themselves are another solute particle (like the protein), where both solutes are bathed in a solvent like water or milk.  I now extend the analysis to the case of a protein binding to a single site within the genome.  First, we will make the observation that for a genome that contains an array of identical binding sites, the problem then effectively reduces to a protein binding to a solution of oligos.

For now we will assume that the n sites are independent of one another, hence, we can work with a system of just one site, and realize that to extend the system to all $n$ sites, simply requires scaling the free energy by $n$, and raising the partition function to the power of $n$.  Hence, although each individual site will have fluctuations between being bound and unbound, we can use the $n$ sites as effective data to increase the power of our statistics for learning about the binding energy.
\subsubsection{One binding site}
For the case that the genome can be modeled as $n$ identical binding sites, we can construct a system with $n$ fixed sites where the binding protein number is allowed to vary, (open closed system):
\begin{equation}\label{}
  \Xi = \frac{\xi_o^n}{n!}
\end{equation}
 Here, $\Xi$ is the grand canonical partition function for the $n$ sites.  The independence of the sites means we can simply work with just the grand canonical partition function for a single binding site $\xi_o$, where the factorial is due to the indistinguishably of the $n$ sites.  Hence, we can work with a single site system, and simply note that extensive quantities (such as the binding energy) will simply be multiplies of the single site system (e.g. the binding energy of 10 bound proteins is simply ten times larger than the binding energy of single protein, and the one dimensional volume of one site simply increases by a factor of 10 for ten sites (i.e. length, which is $n$ in units of the binding site length)).


The single binding site is fixed (closed) while the adsorbate is open, hence single site partition function is:
\begin{equation}\label{}
  \xi_o = q_P + q_{SP} \lambda
\end{equation}
here the q's are effective partition functions for solutes in solvent (the dilute limit).  We can renormalize the partition function:
\begin{equation}\label{}
  \xi = 1 + q \lambda
\end{equation}

Here q is the effective partition function of the bound complex, $q= q_{SP}/q_P$.  Clearly $\xi_o$ and $\xi$ are different numerically.  However, for relative probabilities the forms are irrelevant.  Hence the occupancy (relative probability between bound to unbound) is:
\begin{equation}\label{gc}
P_b = \frac{q\lambda}{\xi_o}=\frac{q\lambda}{1+q\lambda}.
\end{equation}
The absolute activity ($\lambda=\exp( \mu /kT)$) contains the chemical potential that is equal to the potential of both the free protein (the protein floating around in the nucleoplasm) and the protein that is bound on the site (i.e. that is in our system).   This is because in equilibrium, the chemical potential of the reservoir of particles (free protein) must equal the chemical potential of the bound protein.  This is simply the definition of equilibrium.  If the potentials are unequal, which certainly occurs in development, then there will be a net flux into or out of our system (the binding site), until the potentials equilibrate.  Utilizing the fact that the chemical potentials of the reservoir and system are equal gives us two potential equations, one in the form of the a controllable parameter (the free protein with concentration $c_P$ that is related to the potential of Eq.~$\ref{chemc}$) and another in the form of partition function of the grand canonical ensemble (i.e. solve for the potential in Eq.~$\ref{gc}$), relating these allows for us to rewrite the occupancy as:
\begin{equation}
P_b = \frac{c_pK}{1+c_pK} = \frac{c_{PS}}{c_P + c_{PS}},
\end{equation}
which is utilized extensively in chapter 3 of my dissertation for calculations of the occupancy of factors on multiple heterogeneous DNA binding sites of \textit{cis} regulatory modules.  For further details on this topic see also chapter 2 of Hill\cite{hill}. 

\subsubsection{Two dependent binding sites}
 For a system with two identical independent binding sites we have:
\begin{equation}\label{}
  \xi = 1 + 2qc + q^2 c^2
\end{equation}

% cooperativity needs to be emphasized or started as a subsection so it goes in the index.. 2015..
We will be interested in cooperativity between the two bound adsorbates, a dependency, which will modify the above function to:
\begin{equation}\label{}
  \xi = 1 + 2qc + y q^2 c^2
\end{equation}
Here y is the exponential of the work required to perform the following reaction 10 + 01 = 11 + 00, where 00 is the unbound unbound configuration etc..  This process requires no energy unless there is an interaction between the adsorbates.  Using Hill's formalism we have in general:
\begin{equation}\label{y11}
   \xi = y_{00} + qc(y_{10} + y_{01}) + y_{11}q^2 c^2
\end{equation}
For example, $y_{11}=y$, and contains cooperativity for bound protein-protein interactions, while $y_{00}$ refers to an interaction that occurs between the two binding sites (an interaction that occurs in the configuration 00).

Furthermore, to compute the  probability of any configuration occurring we simply extract the corresponding term from the partition function and compute the relative probability.  For example, the probability of configuration 11 where both proteins are bound is:
 \begin{equation}\label{y11}
   P = \frac{yq^2 c^2}{\xi}.
\end{equation}

\subsubsection{A genome of $n$ dependent binding sites}
For $n$ binding sites, where the bound proteins interact, there are a total of $2^n$ different types of possible interactions that may be accounted for.  For the case that only nearest neighbors interact, we have $\Xi=\frac{\xi^n}{n!}$, where $\xi=1+yqc$ such that y contains the interaction energy.  For the case that all $n$ sites are different, yet there are still nearest neighbor interactions of bound factors we have: $\Xi=\prod_i^n \xi_i$, where $\xi_i=1+y_i q_i c$.

\subsubsection{Highly correlated systems, the k-mer sequence and recognition problem}


We've been treating sequences $S$, as if they were simply particles. DNA sequences consist of units of bases: A,C,G,T.  Proteins, like transcription factors, may prefer one base over another, and in general may prefer a specific ordering of specific bases, for example 5'-AAAT may not be equivalent to 5'-TAAA  Notice these are not genetic complements (e.g. 5'-AAAT complements 5'-ATTT, where I will always write DNA sequences in the 5' to 3' direction). 

Rather they are mathematical permutations of one another.  For the case that one considers a k-mer, a binding site that contains k consecutive component sites that are all bound or all unbound, the k component sites can be aggregated into just one binding site (since they're completely correlated).  This is the form I use for the representation of transcription factor binding sites, where each component of the k internal sites represents a DNA base \footnote{This is a form widely accepted possibly due to natural selection acting at the units of the bases (which are roughly the chemical functional groups)}, where base really means base-pair, since proteins bind to the double-stranded DNA-but we only use one strand for the representation of the binding site to keep notation simple.  For example, a specific 3-mer of DNA, is 5'-AAA, where the protein is really binding to the complex of 5'-AAA and 5'-TTT.  And rather than constructing a closed open system for the DNA and adsorbate for each component of the sequence, we instead construct a closed open system for the aggregate.  Hence the configurations for the closed open system would simply be bound or unbound; identical to the problem of a single binding site with variable number of adsorbate.  Another example is two dimers.  For example, 5'-AA and 5'-AA, which consist of the sequence 5'-AAAA.  This is simply considered as two binding sites, and hence has four configurations 00,10,01,11, where the 01 configuration indicates the first two bases of AA are unbound, while the last dimer is bound by the adsorbate.  Hence this can be treated identically to how two binding sites were treated above.

An additional complexity will be to not only introduce each base as having a specific binding energy (so 4 distinct binding energies), but each base \textit{within} the k-mer as having a specific binding energy.  Hence the binding energy will be based on a function of 4*k possible energies.  This means that for a lattice of k sites, we treat each site independently in terms of their binding energies, yet in terms of the binding to the k-sites, the sites are completely correlated.  Hence the binding energy of a k-mer $S$ to a specific adsorbate is:
\begin{equation}
E_b= E(S)=\sum_i^k E(S_i),
\end{equation}\label{energyS}
and the binding constant for the k-mer to the adsorbate is:
\begin{equation}
K(S)=\prod_i^k K(S_i).
\end{equation}

  This complexity can be increased by considering a hierarchy of possible internal interactions, or cooperativity within the binding site, such that the top of the hierarchy has $4^k$ possible energies.  This hierarchy is explored commonly in the interdisciplinary literature through different probabilistic models of sequences. 

In 1987, Berg and von-Hippel (BvH) introduce their evolutionary selection model of protein DNA regulatory sequences, which effectively unites the idea of the highly correlated binding problem to Multiple Sequence Alignment.  Staden, three years earlier, had introduced the idea of making a table to organize the count data from a MSA.  At the time, Multiple Sequence Alignment was an emerging field (Smith-Waterman's local pairwise alignment was only invented 3 years earlier), Blast does not appear until 1990, and the first named Hidden Markov Model applied to sequences, according to Durbin, is 1994\cite{BSA}.  The k-mer binding sites in the 1987 BvH paper\cite{pmid3612791}, were modeled by what are called a Position Weight Matrices, PWMs, which would eventually be recognized as a HMM in Durbin's text\cite{BSA}, see chapter 5, where the PWMs are called Position Specific Scoring Matrices, PSSMs.



\subsubsection{K-mers and PWM binding constants}
We know that we can treat the binding of a protein to a k-mer (a sequence $S$) using standard thermodynamics, for example, in units of the thermal energy, we have:
\begin{equation}\label{}
  K(S) = \frac{[PS]}{[P][S]} = e^{(-E(S))},
\end{equation}
where $E(S)$ is the binding energy that we will assume obeys Eq. \ref{energyS}.
We would like to know the binding constant of the adsorbate to all possible $4^k$ sequences $S$.  This is tedious and possibly experimentally infeasible.  We can use the binding to the highest affinity binding sequence (the 'concensus' sequence ($S_o$)) as a reference point.  Then we can define (redefine) $E(S)$ as the perturbation energy or the amount the binding energy increases when one perturbs the system from $S_o$ to sequence $S$.  Hence we define a reference energy or zero of energy as $E(S_o)=0$ which is an arbitrary choice of reference\footnote{Note, we are not saying $K(S_o)= \frac{[PS_o]}{[P][S_o]} = e^{(-E(S_o))}=1$.  Rather, in a sense, we are redefining the 'binding energy' to be a perturbation energy, defined by $E(S) =\ln \frac{K(S)}{K(S_o)}$, where it is clear that to compute the work to separate $S$ bound by $P$ would require \textit{a priori} knowledge of $K(S_o)$, which must be experimentally determined, in addition to the experimental determination of $K(S)$.  Hereafter, unless explicity stated, this perturbation energy $E$ will simply be called the binding energy.  Furthermore, in chapter 2, we denote $E(S)$ as a bioinformatic binding energy that is inferred from sequence data, and $G(S)$ (a Gibbs free energy).  In this chapter, it is best to think of $E(S)=G(S)$, namely as a biochemical energy.}.  

  From the perspective of Hill's perturbation theory (see page 29 of Hill\cite{hill}), we see that we could model perturbations from a reference system by:
\begin{equation}\label{}
  K(S) =K_o e^{-E(S)}
\end{equation}
Here we have generalized the binding constant of a protein to \textit{any} sequence $S$ of length k.  Physically this is hard to imagine experimentally in real time for a bound protein-DNA system, as we're talking about changing just part of the genetic material (a base or two) bound to the protein while keeping in tack the bulk of the binding site.  However, since the end result of the process is 'path independent', it is irrelevant the method used to cause the perturbation, hence the perturbation may even be an evolutionary mutation of a binding site.

Assuming that each position within the binding site is independent, we can then construct a table of all the single mutation perturbations away from the concensus, thereby allowing us to estimate binding energy for all possible k-mers.  This table contains the matrix elements of the so-called energy Position Weight Matrix, discussed in more detail in Chapter 2, which is used in computational algorithms that 'search' for binding sites for transcription factors.
\subsubsection{Single binding site protein systems in distinct environments}
We can further imagine perturbations to the binding energy due to the environment of the binding site.  For example, if we have two distinct environments, $c$ and $u$, which will become useful ideas in Chapter 2. we could construct two distinct binding constant tables, where the binding constant for any given sequence in environment $c$ would be:
\begin{equation}\label{}
  K(S)^c =K_o^c e{(-E(S)^c)},
\end{equation}
and similarly in environment $u$:
\begin{equation}\label{}
  K(S)^u=K_o^u e^{(-E(S)^u)}
\end{equation}
In environment $c$, we imagine all $4^k$ sequences S (all DNA k-mers) binding constants being measure to be $ K(S)^c$.  Similarly, in environment $u$, we imagine all $4^k$ sequences $S$ binding constants being measured to be $ K(S)^u$.  Statistically we are  assuming $P(S|c)\neq P(S)$, and similarly for environment $u$, where $P(S)$ is the probability that sequence $S$ is bound by the adsorbate when all possible $4^k$ k-mer sequences compete for binding with the adsorbate.  Hence $P(S)$ is the occupancy of sequence $S$ and the adsorbate normalized by the sum over all possible occupancies of the $4^k$ k-mer sequences, where the occupancy is calculated for all k-mer sequences under the same concentration of the adsorbate.

These environments could be considered at the cis-level, that is at the level of the genome.  Hence, the environments $c$ and $u$, could be determined by whether or not a cooccurring binding site is near the sequence $S$ or not near.  For example, one could imagine the environment $c$ is due to cooperative interactions that have evolved between the cooccurring binding sites, while environment $u$ is due to uncooperative or just plain independent binding to the cooccurring binding sites.  We explore this problem in detail in chapter 2, where we consider the possibility that Dorsal binding sites have evolved as a mixture of distinct motifs due to a '$c$' and '$u$' cis-environment acting as a selective force to maintain to the component motifs.  This is an example of 'epistasis' where multiple genes (i.e. the cooccurring binding sites) are selected for jointly (i.e. the sites are not evolutionarily independent.)

\subsubsection{An example of two k-mer binding sites system using a mixture}
Now we can imagine two k-mer binding sites adjacent on a lattice (there may be intervening nonspecific lattice sites between the two k-mer sites that act as 'spacers'), the important point is that we label two disinct locations (each of length k) on the lattice to be sites.  For example two dimers separated by a spacer: $S$'= AANNNNCC, where AA is the first dimer, and CC is the second dimer, and NNNN is a spacer of DNA that the adsorbate does not recognize as a binding site.  The two k-mer sites each bind distinct adsorbates, for example the adsorbate Dorsal binds AA and the adsorbate Twist binds CC.  We can \textit{explicitly} account for lateral interactions between the sites using the 'y' factors previously introduced.  The lateral interaction can be adsorbate-adsorbate or sequence-sequence.

For example, there may be a sequence-sequence interaction between the particles AA and TT.  This can be accounted for by:
\begin{equation}\label{}
  y_{11} =\exp( w(S') ) = \exp( E(S)^c - E(S)^u )= E(AA)^c-E(AA)^u,
\end{equation}
\\
where we have introduced the energy terms from above that were from the environments, $c$ and $u$. Here $y_{11}$ is an exponential factor that contains the cooperative energy $w(
S')$ that is function of the underlying sequence $S$', and is defined by our equation \eqref{y11}, and is further defined on page 100 of Hill\cite{hill} for generalized binding site systems.  If there is a sequence-sequence interaction, then the binding energies $E(S)^c, E(S)^u$ may be different, although it is not a necessary condition for a sequence-sequence interaction to manifest itself in this form.

An \textit{implicit} form of cooperativity at the sequence-sequence level is to just use $E(S)^c$ for the case that Dorsal binding site k-mer cooccurs with a Twist binding site k-mer.  This form contains the binding energy to the sequence along with a shift in the binding site energy due to the interaction with its cis-environment.  The shift being modeled as a Kullback Leibler divergence between the cis-specific environment relative to the case that the case that the binding site is independent of its environment.
