
\section{Thermodyanmics}
Our interest is not in isolated physical systems, as the M particle system above, rather we are interested in closed (energy is exchangeable, \textit{but} particles are not exchangeable) and open (energy is exchangeable, \textit{and} particles are exchangeable) systems.  The Victorian founders of the field of open and closed systems, of thermodynamics, were contemporaries with Charles Darwin, which is very fitting seeing that their insights into heat and particle exchange (a form of work) supplies the essential mechanics to describe biological systems.

Conservation of energy for isolated systems is a consequence of Newton's second law. A more interesting statement is that the energy of a closed system in equilibrium can not spontaneously change, this is the statement of the first law of thermodynamics.  Hence we must do work or heat the system to change its internal energy\footnote{The Clausius convention for the form of the first law: $dU = q -w =$ heat supplied to the system ($q$) - work done by the system ($w$)}. 

\begin{eqnarray}
% \nonumber to remove numbering (before each equation)
  dU &=& q - w \label{eq:xdef} \\  \nonumber
  dU &=& TdS + PdV
\end{eqnarray}
 Here $U$ is the internal energy, the internal energy of the system is the Hamiltonian, $H$, hence $H=U$.  In \eqref{eq:xdef} $q$ is the heat ($q$ has nothing to do with the partition function, which uses the same symbol), and $w$ is the work (the work also accounts for particle exchange processes).    
      
 The system above only has one type of particle, for systems that allow transcription factor to bind to DNA segments it is necessary to introduce multiple particle species (the protein and DNA).  By Gibbs phase rule, we know that for a binary system we will need four independent variables, one of which is intensive.  Hence we have many options available for constructing binary particle ensembles.  For the species that can vary particle number the natural variable is the chemical potential, while for systems that are closed the natural variable is just the particle number.  Hence, for a binary system, composed of M components of S' (sequences) and N components of P' (protein ), we could define the open open system with the following coordinates $( \mu_{S'}, \mu_{P'},V,T)$; while the closed-closed system has the following form:
   \begin{eqnarray}
  dU &=& TdS + \mu_{S'} dM + \mu_{P'} dN + PdV
\end{eqnarray}\label{closedclosed} 
%
%  These transformations are critical for solvent-solute -solute systems.  For example the nucleoplasm-genome-protein systems, where the 'nucleoplasm' is the biomaterial and water that surrounds the genome, and the 'genome-protein' or binding site - protein can be seen as a solute-solute interaction.  
  
  We will think of binding sites interacting with proteins as solute solute interactions that are occurring in a solvent.  The nucleoplasm represents a very complicated solvent, a mixture in the liquid phase of all sorts of complicated biopolymers and water molecules and the many other inorganic substances in a biological nucleus.  Of course, the protein that must find a specific binding site within the genome, must compete with all the other molecules in the nucleus for occupying any point in the spatial grid of the nucleus.  However, again, my aim is to represent and describe the recognition of a particular binding site by a protein, hence I would like to make progress specifically on the recognition problem, without being hampered by the solvent properties.  Hence, I will introduce an argument in T.Hill's text\cite{hill}, and also discussed by Landua\cite{landaumech}, the so-called 'dilute limit'.  This will allow us to rigorously account for the fact that the protein and DNA are embedded in a phyiological solvent, while, to a large degree, hides the solvent molecular details and the solvent-solute details by introducing an effective molecular partition function $q$, which will be similar to Eq.\ref{idealgasq} in two ways: first because the momentum will not be of interest and second because we will be taking ratio of two types of well-defined systems to define the 'effective' partition function.  However, $q$ is different than \ref{idealgasq} in that a molecular partition function is about one type of particle (one molecule), where for large systems like a gas of n identical and distinguishable molecules, one commonly denotes the partition function as $Q=q^n$, hence lowercase is to denote 'one molecule', and capital case to denote large systems.  By defining the effective partition function we will then proceed to the relevant problem of the solute-solute (protein-binding site) interaction, where the physiological environment (solvent) will be accounted for in both the DNA and protein by defining an effective partition funtion for each solute (e.g. $q_{DNA}$ and $q_{pro}$).
 
  
  \emph{Solvent Solute, dilute limit}
  The solvent solute system is just a binary system.  Here we will follow Hill's approach, which is to start off by organizing the liquidey solution with the two component grand canonical system\footnote{The grand canonical ensemble is related to the thermodynamic grand potential, by the legendre transform of Eq.\ref{closedclosed}, the transform leads to: $dU = TdS + <M> d\mu_{S'}  +<N> d\mu_{P'}  + PdV$}
  \begin{equation}\label{xi1}
    \exp^{\frac{PV}{kT} } = \Xi(\mu_S, \mu_P,V,T) = \sum_{N_1} \sum_{N_2} Q(N_1, N_2,V,T) \exp{\frac{(N_1 \mu_{1} + N_2 \mu_{2})}{kT}}
  \end{equation}
Here we have relabelled S as 1 and P as 2, and denoted the two-component canonical ensemble as $Q(N_1, N_2,V,T)$\footnote{In the case of noninteracting solvent and solute $Q(N_1, N_2,V,T)$ factorizes into two 'ideal gas' ensembles, namely:  $Q(N_1, N_2,V,T)=\frac{Q(N_1,V,T)^{N_1}}{N_1!} \frac{Q(N_2,V,T)^{N_2}}{N_2!}$, while for interacting solvent and solute the interaction energy is contained in the potential energy of of the Hamiltonian, and hence $Q(N_1, N_2,V,T)$ can not be factorized.  Regardless of this interaction we can proceed to the 'recognition problem' and construction of an effective partition function being aware that explicit representation of the solvent solute interaction will require writing a potential between the solvent-solute in the Hamiltonian of Eq.\ref{canon}, which are details we wish to hide.}.  Now we know the average solute particle number:
\begin{equation}\label{averageN1}
  < N_2 > = \sum_{n_2}  n_2 P(n_2) = \lambda_{2}  \frac{\partial\log \Xi}{\partial \lambda_{2}}
\end{equation}
By taking the derivative with respect to the absolute activity of the solute, $\lambda_{2}=\exp{\frac{N_2\mu_{2}}{kT}}$, we can calculate the average number of solute particles.  To take this derivative, first notice that in the dilute limit of solute, the summation over the solute may as well be neglected, since the solute activity approaches zero.  If we define the pure solvent grand partition function as $\Psi_o=\sum_{N_1} Q(N_1,0,V,T)\lambda_1^{N_1}$, and the solvent grand partition function $\Psi_1=\sum_{N_1} Q(N_1,1,V,T)\lambda_1^{N_1}$ as the grand for the solvent with one solute embedded in it\footnote{Note that $\Psi_1$ will posses a solute solvent interaction inside of $Q(N_1,1,V,T)$ only if the solute interacts with the solvent, otherwise $Q(N_1,1,V,T)$ is simply $Q(1,0,V,T)^{N_1}Q(0,1,V,T)$ for the case that the solvent particles are identical and distinguishable.}.  Then the derivative will appear as:
\begin{equation}\label{}
  \lambda_{2}  \frac{\partial\log \Xi}{\partial \lambda_{2}} = \lambda_{2} \frac{\Psi_1 + 2* \Psi_2 \lambda_{2} +3*\Psi_3 \lambda_{2}^2 \dots  }{\Psi_0 + \Psi_1 \lambda_{2} +  \Psi_2 \lambda_{2}^2 +\Psi_3 \lambda_{2}^3 \dots }
\end{equation}
As $\lim_{\lambda_{2} \to +0}$, we find that:
\begin{equation}\label{averageN}
  < N_2 > = \frac{ \Psi_1}{\Psi_0} \lambda_2
\end{equation}
Hence, just as in Eq.\ref{idealgasq} where we defined the effective partition function, $q$, the configuration integral, here again we will define an effective partition function for a solution system.  Hence, for a solute immersed in a solvent we will define the effective partition function for the solute as:
\begin{equation}\label{qref}
  q(N,V,T) \equiv \frac{ \Psi_1(\mu_1,N_2=1,V,T) }{\Psi_0(\mu_1,N_2=0,V,T)}
\end{equation}
We can approximate the grand canonical ensemble partition functions on the right hand side of the above equation by using the maximum term of the partition function:
%\begin{equation}\label{solvent}
%  q= \frac{ \Psi_1(\mu_M,N_2=1,V,T) }{\Psi_0(\mu_M,N_2=0,V,T)} \approx \frac{Q_m(<N_1>,1,V,T)}{Q_m(<N_1>,0,V,T)}\exp^{\frac{\Delta E}{kT}}
%\end{equation}
\begin{equation}\label{solvent}
  q= \frac{ \Psi_1(\mu_1,N_2=1,V,T) }{\Psi_0(\mu_1,N_2=0,V,T)} \approx \frac{Q_m(<N_1>,1,V,T)}{Q_m(<N_1>',0,V,T)}\lambda^{-(<N_1> - <N_1>')}
\end{equation}
here, $Q_m(N_1,1,V,T)$ is the canonical partition function for one solute in a box of size V of solvent particles, where the subscript m indicates we have taken the largest term of the grand canonical ensemble.  The maximum term's particle number is denoted as $N_{m}$, where $N_{m_1}=<N_1>$ due to the Gaussian property that the maximum occurs at the expected value (where $<N_1>'$ is a slightly different maximum for the constant volume case of no solute molecules (because the now evacuated space leaves more room for solvent to fill).  The average solvent particle numbers are nuisance variables that we can, in a sense, transform out of the effective partition function.  Hence instead of using the two component grand canonical system we will use the two component system with fixed pressure and fixed solvent particle number\footnote{For example, imagine a beaker filled with a fixed number of liquid water molecules, then if we drop a rock (one solute molecule) inside the beaker the water will rise - i.e. the volume will change); this is unlike the grand canonical case, where we have to dispose of the excess water molecules displaced by the rock (those that don't fit in the volume V), since we must keep the volume fixed (albeit this could be done by allowing the volume of interest to be the beaker filled to the brim, then any excess water molecules will simply flow over the rim; but we're interested in a simple mathematical tool, not a simple experimental design.}.  Hence the new partition function is  
\begin{equation}
\Xi'(N_1, \mu_2,p,T) = \sum_{N_2} \sum_{V} Q(N_1, N_2,V,T)\exp{\frac{-pV}{kT}} \exp{\frac{N_2 \mu_{2}}{kT}},
\end{equation}
where the summation over the volume only works for discrete physical spaces, such as lattices (see Eq.2.23 of Hill\cite{hill}).  Now if we repeat the exact steps above from Eq.\ref{averageN1} to Eq.\ref{solvent} using the new partition function ($\Xi'$), we will arrive at:
\begin{equation}\label{q2}
q = \frac{Q_m(N_1,1,V_m,T)}{Q_m(N_1,0,V_m',T)}\lambda^{-p(V_m - V_m')},
\end{equation}
where again we have used the maximum term method isolating the canonical ensembles that have the largest probability in the partition functions of $\Psi_o'$ and $\Psi_1'$, where, for example the pure solvent grand partition function in this case is $\Psi_o'=\sum_{V} Q(N_1,0,V,T)\exp^{pV/kT}$, where we denote the volume from the maximum term in this summation as $V_m$, and similarly $V_m$' is the maximum term in the partition function (which sums over volumes) of solvent with one solute particle present\footnote{ We can think of $-p(V_m - V_m')$ as the mechanical work $w$ done by inserting a solute into a solvent, namely:$w= P \Delta V$, for example see figure 1.1 of Hill \cite{hill}.   Furthermore, noting that the Helmoholtz is the free energy of the canonical $Q=\exp{(-A/kT)}$, we see that $q=\exp{( \Delta A +p \Delta V  )} = \exp{(\Delta G)}$.}.  


%If this interaction energy is much much larger than the interaction or recognition energy of the protein-DNA binding we would be hampered by the solvent properties, and hence we will assume this is not the case.  However, possibly more important, is the form of the above partition function gives us a way to proceed with the recognition problem while accounting for the solvent.  Hence the possibility that the solvent would completely invalidate any formulas or equations for the binding process is not possible, as criticisms for solvent effects on the recognition process can always be accounted for \emph{after} we have analyzed the solute-solute interactions, simply by analyzing the solvent-solute interaction $\Delta E$ from Eq.\ref{solvent} relative to the interactions that we will now derive of the solute-solute (protein -DNA).

% now introduce the solute-solute interaction, this thermo stuff needs to be place above or deleted... start with line 244, again delete everything else, or place it above..
\section{Derivation of the chemical potential: $\mu=\mu_o + \ln{(c)}$} 
On page 6 of T.Hill's text\cite{hill}, he derives the dilute limit formula for the chemical potential $\mu=\mu_o + \ln{(c)}$ using a vacuum as a solvent.  After his argument he points out that the derivation he presented could and does take different forms (depending on the text and purposes\footnote{For example, given that $dG=Vdp +SdT$, then for a constant temperature ideal gas system we have $G = G_o +\int V dp = G_o + \int \frac{RT}{p}dp$, where we have used the gas constant R in the ideal gas law in the last expression.  This results in $G=G_o +\ln{\frac{p}{p_o}}$, where $p_o$ is the reference (standard state) of one bar, which is usually omitted, furthermore using $G=\mu N$, we can divide the equation for $dG$ through by $N$, now after integration this results in $\mu=\mu_o +\ln{p}$, but using the ideal gas law (and keeping in mind that we omitted the reference pressure) we can rewrite this in terms of a reference concentration of one particle per unit volume, resulting in: $\mu=\mu_o +\ln{c}$.} however, he states that for a solute solvent system (biological system), that this approach (which I'll now recapitulate) is necessary (if you want to keep things simple).
 
In Eq.\ref{averageN} we have the absolute activity of the solute, which by definition is $\lambda_{2}=\exp{\frac{\mu_{2}}{kT}}$, hence using the definition of the activity and along with \ref{averageN}, the average solute particle number, we can derive the standard formula for the thermodynamic chemical potential.  First we must define the concentration $c$ (particle density) as:
\begin{equation}
 c = \frac{<N_2>}{V},
 \end{equation}

 Now dividing both sides of Eq. \ref{averageN} by $V$, we can rewrite Eq. 
\ref{averageN} in terms of the density, which results in:
\begin{equation}\label{chemc}
c =  \frac{< N_2 >}{V} =\frac{\lambda_{2}}{V} \frac{ \Psi_1}{\Psi_0}.
 \end{equation}
Now plugging in $\exp{\frac{\mu_{2}}{kT}}$ for $\lambda_{2}$, and taking the logarithm of both sides of Eq. \ref{chemc} results in:
\begin{equation}\label{chemc2}
\log{c} = \log{\frac{\exp{\frac{\mu_{2}}{kT}}}{V} \frac{ \Psi_1}{\Psi_0} }.
 \end{equation}
 
Now let us define $q$ based on the right side of Eq.\ref{q2}, then if we rewrite the right side of Eq.\ref{chemc2} as two terms we have: $\log{c} =\log{\frac{ \mu_{2}}{kT} }  + \log{ \frac{ q}{V } }$.  Upon rearranging terms, and multiplying through by the thermal energy $kT$, and by writing $kT\log{ \frac{ q}{V } }=\mu_o$ (which acts as a reference or a standard state)\footnote{This statistical mechanics approach is in contrast to the thermodynamic approach of the footnote above, where one integrates $dG=Vdp$ \textit{from} some standard state (an arbitrary reference) to a desired \textit{point} (in thermodynamic space, with dimensions like pressure).  Here the \textit{point} we reference is, in a sense, a point in phase space (a finer level of detail than the coarse grained thermodynamic variables.}, we have our desired result:
\begin{equation}
\mu=\mu_o + kT\ln{(c)},
\end{equation}

%Any 'perturbation' from this reference will have a partition function $q$, and a chemical potential $\mu$.  Therefore we have:
% \begin{equation}\label{chemc2}
% \mu - \mu_{ref}  = \log{\frac{N_2}{N_{2ref}} } = \log{\frac{q}{q_ref}}.
% \end{equation}
% Hence for isochoric (constant volume), the ratio of particle numbers between the system and reference ($\frac{N_2}{N_{2ref}}$) is equivalent to the ratio of concentrations ($\frac{c}{c_{ref}}$), where we will use a reference concentration as the 'dilute limit' of one particle (so $< N_2 > =1$), hence we have $\frac{c}{c_{ref}}=c$.
\section*{Nucleoplasm genome ligand binding problem}

The binding site is the main component of our physical system, we will let the number of binding sites be fixed in the genome (i.e. the system is closed with respect to number of binding sites).  Let M be the number of binding sites in the genome, each site being of the same energy.  Let the system be open with respect to factor binding. Hence, each particular locus (each site) is not just either bound or not bound, rather it will have an occupancy.  In equilibrium, we can define the equilibrium binding constant as a function of the concentrations of the components of the system.

The change in free energy per particle, $\Delta \mu$, of the binding process is zero in equilibrium, recall each species in each phase has its own chemical potential:
\begin{equation}\label{chemc}
 \mu = \mu^o + \ln{c},
 \end{equation}
  here $\mu^o$ is the reference energy (standard state), and c is the concentration or density of the chemical specie relative to standard concentration of '1' in the units of interest, hence we also have:
\begin{equation}
% \nonumber to remove numbering (before each equation)
 \mu_{SP} - \mu_S - \mu_P   = 0
\end{equation}
now if we group common standard states and concentrations, and rearrange:
\begin{equation}\label{}
  \mu_{SP}^o - \mu_S^o - \mu_P^o = \ln( \frac{ [SP]_e }{[S]_e [P]_e} )
\end{equation}


Here the subscript e on the concentrations is to remind us that the concentrations are no longer a variable, but fixed by the equilibrium constraint, and we assume units of $kT=1$.  Our chemical potentials are linked to the molecular energies through the logarithm of the dilute limit partition function of Eq.\ref{q2} (if the system is in equilibrium, hence we also have:
\begin{equation}\label{effm}
  \mu_{SP}^o - \mu_S^o - \mu_P^o = \ln( \frac{ q_{SP} } { q_S q_P })
\end{equation}
Here we will assume that $p\Delta V$ factors from Eq.\ref{q2} that arise from the effective molecular partition functions from the righ side expression of Eq.\ref{effm} all cancel.  This is because the pressure is constant, and we will assume the volume of the complex $SP$ is roufly the additive volume of the molecules $S$ and $P$ in isolation in the solvent.  Now we see that the binding energy emerges from the ratio of partition functions, hence, we define a new partition function as:
\begin{equation}\label{}
  q = \frac{ q_{SP} } { q_S } = q_{P} \exp{-\frac{E_b}{kT} }.
\end{equation}

Here, the binding energy, $E_b$ is equal to the work done to separate the bound complex protein and DNA (denoted as the SP particle). It is the solute-solute interaction.  It can also be thought of as the energy to lift an adsorbate out of the potential well of depth $E_b$ that describes the influence of the sequence on the adsorbate, or it could be thought of as the parameter $\sigma$ in the pairwise potential of a Lennard Jones (the depth of the LJ potential).  It determines the potential energy term $U(X_S,X_P)$ that we would have added to our Hamiltonian in equation \eqref{hamiltonian}.  The emergence of $E_b$ by taking the ratio of the effective partition functions is a consequence of the assumption that the molecular degrees of freedom, such as rotation and vibration are unperturbed by the binding process.  For example, for the molecule S, we have $q_S \approx q_r^S q_v^S$, similarly for the molecule P.  The complex SP contains all of these molecular states too, however the complex also contains an additional factor due to the interaction (such as an LJ potential).  Assuming the complex is stable, then we can assume we are at the minima of the pair-wise potential, which we call the binding energy\footnote{ An example of the cancellations of the partition functions: Let $q_r^S$ be the rotational partition function over the eigenvalues of the Hamiltonian for the rotational degrees of freedom, e.g. $q_r^S=\sum_i \exp( H_i^S )$, where i runs over the eigenvalues of the Hamiltonian for the S molecule, similarly for the other degrees of freedom (all the variables are assumed classical, hence we can work in a real vector space, as opposed to a complex vector space).  Then $\frac{q_{PS}}{q_P q_S}= \frac{q_r^P \prod_d q_d^P q_r^S \prod_f q_f^S \exp(-U)}{q_r^P \prod_d q_d^P q_r^S \prod_f q_f^S }$, where d and f run over all remaining 'degrees of freedom' for the molecules S and P, where the form of each degree of freedom's Hamiltonian will determine the eigenvalues and hence the partition functions (the 'momenta' and 'position' random variables of the Eq.\ref{hamiltonian} are seen as 'degrees of freedom'\cite{hobson} in this context, hence the variables of Eq.\ref{hamiltonian} can be seen as generalized coordinates in phase space, where the random variable X, for example, may represent a rotation).  Whatever the form of these Hamiltonians, all of these partition functions cancel if they are unperturbed when P and S form a complex or 'bind', and all that remains is the interaction between S and P denoted as U, which at equilibrium has a value $E_b$.  } 

Linking the statistical mechanic's partition functions to the thermodynamic binding constant we have:

\begin{equation}\label{k}
 K = \exp{-\frac{E_b}{kT} },
\end{equation}
where the binding constant is defined by:
\begin{equation}\label{k}
K=\frac{ [SP]_e }{[S]_e [P]_e}.
\end{equation}
   Experimentally this can be determined by binding titration curves, which allow one to transform the binding constant as a function of the fractional occupancy.  As a consistency check, we see that if the binding energy is zero (no interaction between sequence and protein, then the concentration of the bound complex is just as likely as the unbound complex, while complete binding requires the binding energy to be negative infinity, and for particles that repel such that the bound complex never forms the binding energy must be plus infinity), then we have:
\begin{equation}\label{}
  q_{SP} = q_S q_P.
\end{equation}
Hence, we find that partition functions behave almost identically as joint distributions.  The beauty of partition functions, is that we maintain the molecular link to the Hamiltonian, and a link to thermodynamics.
%The partition function Q is the sum of the weights of each possible outcome (sample) in the sample space (the ensemble.  Each Molecular partition function simply sums over all the possible molecular states of the system.  Of particular interest to us is the binding energy, $\epsilon$, from equation \eqref{1}, which would be a factor inside the molecular partition function $q_{SP}$.
